(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3031:function(e,t,s){Promise.resolve().then(s.bind(s,4162))},4162:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return M}});var r=s(7437),a=s(2265);function n(e){let{message:t}=e,s="user"===t.sender;return(0,r.jsxs)("div",{className:"flex ".concat(s?"justify-end":"justify-start"),children:[(0,r.jsxs)("div",{className:"max-w-[80%] ".concat(s?"order-2":"order-1"),children:[(0,r.jsx)("div",{className:"rounded-lg px-4 py-2 ".concat(s?"bg-purple-600 text-white rounded-br-sm":"bg-gray-100 text-gray-800 rounded-bl-sm"),children:(0,r.jsx)("div",{className:"whitespace-pre-wrap text-sm leading-relaxed",children:t.content})}),(0,r.jsx)("div",{className:"text-xs text-gray-500 mt-1 ".concat(s?"text-right":"text-left"),children:new Date(t.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),!s&&(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center mr-3 mt-1 order-0",children:(0,r.jsx)("span",{className:"text-sm",children:"\uD83E\uDD16"})}),s&&(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center ml-3 mt-1 order-3",children:(0,r.jsx)("span",{className:"text-sm",children:"\uD83D\uDC64"})})]})}function i(){return(0,r.jsxs)("div",{className:"flex justify-start",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center mr-3 mt-1",children:(0,r.jsx)("span",{className:"text-sm",children:"\uD83E\uDD16"})}),(0,r.jsx)("div",{className:"bg-gray-100 rounded-lg rounded-bl-sm px-4 py-2",children:(0,r.jsxs)("div",{className:"flex space-x-1",children:[(0,r.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),(0,r.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,r.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]})}function l(e){let{messages:t,isLoading:s,messagesEndRef:a}=e;return(0,r.jsxs)("div",{className:"h-full overflow-y-auto chat-scrollbar p-4 space-y-4",children:[t.map(e=>(0,r.jsx)(n,{message:e},e.id)),s&&(0,r.jsx)(i,{}),(0,r.jsx)("div",{ref:a})]})}function o(e){let{onSendMessage:t,disabled:s=!1}=e,[n,i]=(0,a.useState)(""),l=()=>{n.trim()&&!s&&(t(n.trim()),i(""))};return(0,r.jsxs)("div",{className:"border-t border-gray-200 p-4 bg-white",children:[(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),l()},className:"flex space-x-2",children:[(0,r.jsx)("textarea",{value:n,onChange:e=>i(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),l())},placeholder:"Ask me to run a script on this page...",className:"flex-1 resize-none border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:2,disabled:s}),(0,r.jsx)("button",{type:"submit",disabled:!n.trim()||s,className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center min-w-[60px]",children:s?(0,r.jsx)("div",{className:"w-4 h-4 border-2 border-white/20 border-t-white rounded-full animate-spin"}):(0,r.jsx)("span",{children:"Send"})})]}),(0,r.jsx)("div",{className:"text-xs text-gray-500 mt-2",children:"Press Enter to send, Shift+Enter for new line"})]})}function c(){return(0,r.jsxs)("div",{className:"bg-gradient-to-r from-purple-600 to-purple-800 text-white p-4 flex items-center justify-between shadow-lg",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("span",{className:"text-2xl",children:"\uD83D\uDE80"}),(0,r.jsx)("h1",{className:"text-lg font-semibold",children:"Dynamic Script Runner"})]}),(0,r.jsx)("button",{onClick:()=>{console.log("[Header] Close button clicked"),window.parent&&window.parent!==window&&window.parent.postMessage({type:"CLOSE_SIDEBAR"},"*")},className:"w-8 h-8 rounded-md bg-white/20 hover:bg-white/30 transition-colors flex items-center justify-center text-xl font-bold",title:"Close sidebar",children:"\xd7"})]})}function d(){let[e,t]=(0,a.useState)([{id:"1",content:"Hello! I'm your AI assistant. I can help you run dynamic scripts on any website. Try asking me to:\n\n• Change the background color\n• Fill out forms\n• Summarize content\n• Navigate complex sites\n\nWhat would you like to do?",sender:"assistant",timestamp:Date.now()}]),[s,n]=(0,a.useState)(!1),i=(0,a.useRef)(null),d=()=>{var e;null===(e=i.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,a.useEffect)(()=>{d()},[e]);let h=async e=>{if(console.log("[Chat] Sending message:",e),!e.trim()){console.log("[Chat] Empty message, ignoring");return}let s={id:Date.now().toString(),content:e,sender:"user",timestamp:Date.now()};t(e=>[...e,s]),n(!0);try{setTimeout(()=>{let s={id:(Date.now()+1).toString(),content:'I understand you want to: "'.concat(e,"\"\n\nI'll help you create a script for that. This feature is coming soon! \uD83D\uDE80"),sender:"assistant",timestamp:Date.now()};t(e=>[...e,s]),n(!1)},1e3)}catch(e){console.error("[Chat] Error sending message:",e),n(!1)}};return(0,r.jsxs)("div",{className:"h-full flex flex-col bg-white",children:[(0,r.jsx)(c,{}),(0,r.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,r.jsx)(l,{messages:e,isLoading:s,messagesEndRef:i})}),(0,r.jsx)(o,{onSendMessage:h,disabled:s})]})}class h{connect(){if(!this.isConnecting&&(!this.ws||this.ws.readyState!==WebSocket.OPEN)){this.isConnecting=!0;try{this.ws=new WebSocket("ws://localhost:3456"),this.ws.onopen=()=>{console.log("Connected to agent server"),this.isConnecting=!1,this.emit("connected",{})},this.ws.onmessage=e=>{try{let t=JSON.parse(e.data);this.handleEvent(t)}catch(e){console.error("Failed to parse WebSocket message:",e)}},this.ws.onerror=e=>{console.error("WebSocket error:",e),this.isConnecting=!1},this.ws.onclose=()=>{console.log("Disconnected from agent server"),this.isConnecting=!1,this.emit("disconnected",{}),this.scheduleReconnect()}}catch(e){console.error("Failed to connect to agent server:",e),this.isConnecting=!1,this.scheduleReconnect()}}}scheduleReconnect(){this.reconnectTimeout&&clearTimeout(this.reconnectTimeout),this.reconnectTimeout=setTimeout(()=>{console.log("Attempting to reconnect to agent server..."),this.connect()},5e3)}handleEvent(e){this.emit(e.type,e),this.emit("event",e)}emit(e,t){let s=this.listeners.get(e);s&&s.forEach(e=>e(t))}on(e,t){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t),()=>{let s=this.listeners.get(e);s&&s.delete(t)}}async checkHealth(){try{let e=await fetch("".concat(this.baseUrl,"/health"));return e.ok}catch(e){return console.error("Health check failed:",e),!1}}async createTask(e,t){let s=await fetch("".concat(this.baseUrl,"/tasks"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({task:e,options:t})});if(!s.ok)throw Error("Failed to create task: ".concat(s.statusText));return s.json()}async getTask(e){let t=await fetch("".concat(this.baseUrl,"/tasks/").concat(e));if(!t.ok)throw Error("Failed to get task: ".concat(t.statusText));return t.json()}async listTasks(){let e=await fetch("".concat(this.baseUrl,"/tasks"));if(!e.ok)throw Error("Failed to list tasks: ".concat(e.statusText));return e.json()}async cancelTask(e){let t=await fetch("".concat(this.baseUrl,"/tasks/").concat(e),{method:"DELETE"});if(!t.ok)throw Error("Failed to cancel task: ".concat(t.statusText))}disconnect(){this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null),this.ws&&(this.ws.close(),this.ws=null)}constructor(){this.baseUrl="http://localhost:3456",this.ws=null,this.listeners=new Map,this.reconnectTimeout=null,this.isConnecting=!1,this.connect()}}let u=new h,m=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),x=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),p=e=>{let t=x(e);return t.charAt(0).toUpperCase()+t.slice(1)},g=(...e)=>e.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim(),f=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var y={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let b=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:r,className:n="",children:i,iconNode:l,...o},c)=>(0,a.createElement)("svg",{ref:c,...y,width:t,height:t,stroke:e,strokeWidth:r?24*Number(s)/Number(t):s,className:g("lucide",n),...!i&&!f(o)&&{"aria-hidden":"true"},...o},[...l.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(i)?i:[i]])),w=(e,t)=>{let s=(0,a.forwardRef)(({className:s,...r},n)=>(0,a.createElement)(b,{ref:n,iconNode:t,className:g(`lucide-${m(p(e))}`,`lucide-${e}`,s),...r}));return s.displayName=p(e),s},j=w("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),k=w("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),v=w("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),N=w("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),S=w("wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),E=w("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),C=w("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);function D(){let[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(""),[i,l]=(0,a.useState)(!1),[o,c]=(0,a.useState)(!1),[d,h]=(0,a.useState)(null),[m,x]=(0,a.useState)({});(0,a.useEffect)(()=>{let e=u.on("init",e=>{e.tasks&&t(e.tasks)}),s=u.on("connected",()=>{c(!0)}),r=u.on("disconnected",()=>{c(!1)}),a=u.on("task-update",e=>{e.task&&t(t=>t.map(t=>t.id===e.task.id?e.task:t))}),n=u.on("task-created",e=>{e.task&&t(t=>[...t,e.task])}),i=u.on("task-completed",e=>{e.task&&t(t=>t.map(t=>t.id===e.task.id?e.task:t))}),l=u.on("task-failed",e=>{e.task&&t(t=>t.map(t=>t.id===e.task.id?e.task:t))}),o=u.on("screenshot",e=>{e.taskId&&e.data&&x(t=>({...t,[e.taskId]:[...t[e.taskId]||[],e.data]}))});return u.checkHealth().then(c),()=>{e(),s(),r(),a(),n(),i(),l(),o()}},[]);let p=async()=>{if(s.trim()&&!i){l(!0);try{let{taskId:e}=await u.createTask(s.trim());n(""),h(e)}catch(e){console.error("Failed to create task:",e),alert("Failed to create task. Make sure the agent server is running.")}finally{l(!1)}}},g=e=>{switch(e){case"pending":return(0,r.jsx)(j,{className:"w-4 h-4 text-yellow-500"});case"running":return(0,r.jsx)(k,{className:"w-4 h-4 text-blue-500 animate-spin"});case"completed":return(0,r.jsx)(v,{className:"w-4 h-4 text-green-500"});case"failed":return(0,r.jsx)(N,{className:"w-4 h-4 text-red-500"})}},f=e=>{switch(e){case"pending":return"bg-yellow-50 border-yellow-200";case"running":return"bg-blue-50 border-blue-200";case"completed":return"bg-green-50 border-green-200";case"failed":return"bg-red-50 border-red-200"}};return(0,r.jsxs)("div",{className:"h-full flex flex-col bg-gray-50",children:[(0,r.jsxs)("div",{className:"bg-white border-b px-4 py-3 flex items-center justify-between",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-800",children:"Browser Automation"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[o?(0,r.jsx)(S,{className:"w-4 h-4 text-green-500"}):(0,r.jsx)(E,{className:"w-4 h-4 text-red-500"}),(0,r.jsx)("span",{className:"text-xs text-gray-500",children:o?"Connected":"Disconnected"})]})]}),(0,r.jsxs)("div",{className:"p-4 bg-white border-b",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",value:s,onChange:e=>n(e.target.value),onKeyPress:e=>"Enter"===e.key&&p(),placeholder:"Describe what you want to automate...",className:"flex-1 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!o||i}),(0,r.jsx)("button",{onClick:p,disabled:!o||i||!s.trim(),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:i?(0,r.jsx)(k,{className:"w-5 h-5 animate-spin"}):"Run"})]}),!o&&(0,r.jsx)("p",{className:"mt-2 text-sm text-red-600",children:"Agent server is not connected. Make sure it's running on port 3456."})]}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:0===e.length?(0,r.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No automation tasks yet. Create one above!"}):e.map(e=>(0,r.jsxs)("div",{className:"border rounded-lg p-4 cursor-pointer transition-all ".concat(f(e.status)," ").concat(d===e.id?"ring-2 ring-blue-500":""),onClick:()=>h(e.id===d?null:e.id),children:[(0,r.jsxs)("div",{className:"flex items-start justify-between",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[g(e.status),(0,r.jsx)("span",{className:"text-sm font-medium capitalize",children:e.status})]}),(0,r.jsx)("p",{className:"text-sm text-gray-700 line-clamp-2",children:e.id}),e.progress&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-1",children:[(0,r.jsxs)("span",{children:["Step ",e.progress.currentStep," of ",e.progress.totalSteps]}),e.progress.lastAction&&(0,r.jsx)("span",{className:"font-medium",children:e.progress.lastAction})]}),(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,r.jsx)("div",{className:"bg-blue-500 h-1.5 rounded-full transition-all",style:{width:"".concat(e.progress.currentStep/e.progress.totalSteps*100,"%")}})})]})]}),(0,r.jsx)(C,{className:"w-5 h-5 text-gray-400 transition-transform ".concat(d===e.id?"rotate-90":"")})]}),d===e.id&&(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t space-y-3",children:[e.error&&(0,r.jsxs)("div",{className:"p-3 bg-red-100 rounded text-sm text-red-700",children:["Error: ",e.error]}),m[e.id]&&m[e.id].length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Screenshots"}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2",children:m[e.id].map((e,t)=>(0,r.jsx)("img",{src:"data:image/png;base64,".concat(e),alt:"Screenshot ".concat(t+1),className:"w-full rounded border cursor-pointer hover:opacity-80",onClick:t=>{t.stopPropagation(),window.open("data:image/png;base64,".concat(e),"_blank")}},t))})]}),e.result&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Result"}),(0,r.jsx)("pre",{className:"p-3 bg-gray-100 rounded text-xs overflow-x-auto",children:JSON.stringify(e.result,null,2)})]})]})]},e.id))})]})}let T=w("message-square",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),_=w("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);function M(){let[e,t]=(0,a.useState)("chat");return(0,r.jsxs)("main",{className:"h-screen w-full flex flex-col",children:[(0,r.jsxs)("div",{className:"bg-white border-b flex",children:[(0,r.jsxs)("button",{onClick:()=>t("chat"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium transition-colors ".concat("chat"===e?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-800"),children:[(0,r.jsx)(T,{className:"w-4 h-4"}),"Chat"]}),(0,r.jsxs)("button",{onClick:()=>t("agent"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 text-sm font-medium transition-colors ".concat("agent"===e?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-800"),children:[(0,r.jsx)(_,{className:"w-4 h-4"}),"StageHand"]})]}),(0,r.jsx)("div",{className:"flex-1 overflow-hidden",children:"chat"===e?(0,r.jsx)(d,{}):(0,r.jsx)(D,{})})]})}},622:function(e,t,s){"use strict";var r=s(2265),a=Symbol.for("react.element"),n=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function o(e,t,s){var r,o={},c=null,d=null;for(r in void 0!==s&&(c=""+s),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)n.call(t,r)&&!l.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:d,props:o,_owner:i.current}}t.jsx=o,t.jsxs=o},7437:function(e,t,s){"use strict";e.exports=s(622)}},function(e){e.O(0,[971,472,744],function(){return e(e.s=3031)}),_N_E=e.O()}]);